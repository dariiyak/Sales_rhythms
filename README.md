# Прогнозирование дневных продаж товара

## Описание задачи

Вам предлагается задача прогнозирования спроса для маркетплейса.  
Необходимо предсказать количество проданных единиц товара в конкретный день на основе информации о цене, промо-акциях и складских остатках.

Данные обезличены и содержат историю продаж для тысяч товаров.  
Тестовый период следует сразу после обучающего.

---

## Цель

Построить модель, которая **для каждой пары `товар–день` в тестовом периоде** предскажет **количество проданных единиц товара за день**.

---

## Данные

В распоряжении три файла:

- `train.parquet` — история продаж за обучающий период  
- `test.parquet` — данные за 14 дней, следующих сразу после обучающего периода  
- `sample_submission.csv` — шаблон для отправки решения  

### Описание полей (`train.parquet`, `test.parquet`)

- `nm_id` — анонимный идентификатор товара  
- `dt` — дата  
- `price` — цена товара в данный день  
- `is_promo` — флаг участия товара в промо-акции  
- `prev_leftovers` — остаток товара на складе на начало дня  
- `qty` — количество проданных единиц товара за день  
  (присутствует **только в train**, является целевой переменной)

---

## Метрика качества

Качество решения оценивается с помощью **взвешенной MAE (wMAE)**.

Из-за большого числа дней с нулевыми продажами ошибки в дни, когда продажи были, считаются более важными.

### Веса объектов

- `w_i = 1`, если `y_i = 0`
- `w_i = 7`, если `y_i > 0`

### Формула метрики

wMAE = (Σ w_i · |y_i − ŷ_i|) / (Σ w_i)

где:
- `y_i` — истинное значение продаж  
- `ŷ_i` — предсказание модели  

### Примечание

Вес для дней с продажами (`w_pos = 7`) выбран таким образом, чтобы сбалансировать вклад дней с продажами и без продаж.  
Доля дней с продажами в обучающей выборке составляет примерно `p ≈ 0.13`.

---

## Результат

Необходимо сформировать файл с предсказаниями для всех строк из `test.parquet`  
в формате, соответствующем `sample_submission.csv`.
